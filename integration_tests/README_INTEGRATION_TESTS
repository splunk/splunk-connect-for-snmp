How to run an integration test?

Right now we support only NOVA.
- login into NOVA: https://splunkit.io/ec2
- create an EC2 instance with the following specs:
  - t3.medium
  - 50 GB (this is the default value)
  - ubuntu 18/CentOS 7/CentOS 8
- create a splunk instance with all the default settings
- git clone https://github.com/splunk/splunk-connect-for-snmp.git
- cd splunk-connect-for-snmp
- git checkout <target_branch>
sudo apt -y install docker.io
sudo docker build -t snmp-local
- cd integration_tests
- chmod u+x install_microk8s.sh
- sudo ./install_microk8s.sh
- su <user_name>
- cd ~/splunk-connect-for-snmp


sudo docker save snmp-local > myimage.tar
sudo microk8s ctr image import myimage.tar

sudo docker pull splunk/splunk:latest
sudo docker run -d -p 8000:8000 -p 8088:8088 -p 8089:8089 -e SPLUNK_START_ARGS='--accept-license' -e SPLUNK_PASSWORD='changeme2' splunk/splunk:latest
chmod u+x prepare.splunk.sh
./prepare.splunk.sh
sed -i "s/###SPLUNK_TOKEN###/$(cat hec_token)/" values.yaml
sudo docker run -d -p 161:161/udp tandrup/snmpsim


- sudo microk8s enable helm3

cd ~/splunk-connect-for-snmp/charts/splunk-connect-for-snmp
microk8s helm3 dep update
cd ~/splunk-connect-for-snmp/integration_tests

#  - microk8s helm3 repo add splunk-connect-for-snmp https://splunk.github.io/splunk-connect-for-snmp
# - microk8s helm3 repo update


- microk8s helm3 install snmp -f values.yaml splunk-connect-for-snmp/charts/splunk-connect-for-snmp --namespace=sc4snmp --create-namespace

- ./integration_tests/deploy_and_test.sh -u <splunk_url_or_ip> -p <splunk_admin_password>
  - the test will install/deploy everything, will run all the integration tests and it will prompt
    you this message:
    "Press ENTER to undeploy everything"
    Once you press any key, everything will be undeployed (kubernets, secrets, snmp simulator, ...).
    In this way you can check your Splunk instance/Kubernetes' containers in order to check
    that everything is fine.